# Interface function description

## Paillier
| Function Name | Description | Input | Output |
| ------ | ------ | ------ | ------ |
| keygen(unsigned long bitLen) | generate a PaillierTD public/private key pair (pk; sk) | bitLen – the intense of key | NULL |
| encrypt(mpz_t c, mpz_t m) | encpyt message m to c using public key pk | m – a plaintext, which is mpz_t type. mpz_t  is a GMP data type which is a multiple precision integer(same below). | c – encrypted result, is a ciphertext and mpz_t type. |
| decrypt(mpz_t m, mpz_t c) | decpyt ciphertext c to plaintext m using private key sk | c – a ciphertext, which is mpz_t type. | m – decrypted result, is a plaintext and mpz_t type. |
| add(mpz_t res, mpz_t c1, mpz_t c2)  | additive homomorphism operation | c1 –augend, is a ciphertext and mpz_t type, which must be less than n^2. <br>c2 –another augend, is a ciphertext and mpz_t type, which must be less than n^2  | res – the result of additive homomorphism of c1 and c2, is a ciphertext, also mpz_t type.|
| scl_mul(mpz_t res, mpz_t c, mpz_t e) | scalar-multiplication homomorphism operation | c – is a ciphertext and mpz_t type, which must be less than n^2.<br>e – is a plaintext and mpz_t type, which must be less than n.| res – the result of scalar-multiplication homomorphism of c and e, is a ciphertext, also mpz_t type. |

## ThirdKeyGen
| Function Name | Description | Input | Output |
| ------ | ------ | ------ | ------ |
| thdkeygen(Paillier pai, int sigma, PaillierThd *cp, PaillierThd *csp) | splits sk into two partially private keys (sk1; sk2), while sk is the private key of pai. distributes (pk; sk1) and (pk; sk2) to CP and CSP, respectively | pai – is a Paillier which generate private key and public key.<br>sigma – to generate a random number with sigma bits.<br>cp – stores (pk;sk1). <br>csp – stores (pk, sk2). | NULL |

 ## PaillierThd
| Function Name | Description | Input | Output |
| ------ | ------ | ------ | ------ |
| pdec(mpz_t pc, mpz_t c) | Partial Decryption, using sk1 or sk2 which is generated by thdkeygen | c – is a ciphertext and mpz_t type. | pc – the result of partial decryption, is a ciphertext and mpz_t type. |
| fdec(mpz_t m, mpz_t c1, mpz_t c2) | Threshold Decryption, using sk1 or sk2 which is generated by thdkeygen | c1 – partially decrypted ciphtext which is output of fdec using sk1.<br>c2 – partially decrypted ciphtext which is output of fdec using sk2 | m – the result of partial decryption, is a plaintext and mpz_t type. |

 ## seccomp
| Function Name | Description | Input | Output |
| ------ | ------ | ------ | ------ |
| smul(mpz_t res, mpz_t ex, mpz_t ey, PaillierThd cp, PaillierThd csp) | Secure Multiplication operation | ex – is a ciphertext and mpz_t type.<br>ey – is a ciphertext and mpz_t type.<br>cp – is a PaillierThd which owns sk1.<br>csp – is a PaillierThd which owns sk2. | res – the result of Secure Multiplication, is a ciphertext and mpz_t type. |
 | scmp(mpz_t res, mpz_t ex, mpz_t ey, PaillierThd cp, PaillierThd csp) | compare ex and ey, which are encrypted from plaintext x and y, separately, when x >=y, res is 0, otherwise, res is 1.  | ex – a ciphertext which is encrypted from plaintext x.<br>ey – a ciphertext which is encrypted from plaintext y.<br>cp – is a PaillierThd which owns sk1.<br>csp – is a PaillierThd which owns sk2. | res – the result of secure comparison. |
 | ssba(mpz_t s_x, mpz_t u_x, mpz_t ex, PaillierThd cp, PaillierThd csp) | given a ciphertext ex which is encrypted from plaintext x, get the sign bit and magnitude of x.  | ex – a ciphertext which is encrypted from plaintext x.<br>cp – is a PaillierThd which owns sk1.<br>csp – is a PaillierThd which owns sk2. | s_x – the sign bit of x,if x>=0, it is 0, otherwise 1, in ciphertext.<br>u_x – the magnitude of x, in ciphertext. |
 | sdiv(mpz_t eq, mpz_t er, mpz_t ex, mpz_t ey, int ell, PaillierThd cp, PaillierThd csp, Paillier pai) | given two ciphertextx ex and ey, which are encrypted from plaintext x and y, respectively,  compute the quotient and the remainder of x divided by y.  | ex – a ciphertext which is encrypted from plaintext x. <br>ey – a ciphertext which is encrypted from plaintext y. <br>ell – is a constant (e.g., l = 32) and is used to control the domain size of plaintext. In practice, we can change l to support larger integers. <br>cp – is a PaillierThd which owns sk1. <br>csp – is a PaillierThd which owns sk2.  | eq – the quotient of x divided by y, in ciphertext. <br>er – the remainder of x divided by y, in ciphertext. |
 
